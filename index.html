<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>YUMGOOD Simple Viewer</title>
    <style>
        :root {
            --bg-color: #121212;
            --header-bg: #1e1e1e;
            --border-color: #333;
            --text-color: #e0e0e0;
            --panel-bg: #1a1a1a;
            --btn-border: #555;
            --btn-hover: #444;
            --btn-active-bg: #eee;
            --btn-active-text: #000;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; -webkit-tap-highlight-color: transparent; }

        /* [ì•„ì´í° ì‚¬íŒŒë¦¬ íŠ•ê¹€ ë°©ì§€] */
        html, body { 
            position: fixed; 
            width: 100%; height: 100%; 
            margin: 0; overflow: hidden; 
            background: var(--bg-color); 
            font-family: -apple-system, BlinkMacSystemFont, "Pretendard", sans-serif; 
            color: var(--text-color);
            overscroll-behavior: none; 
            touch-action: none; 
        }
        
        header {
            background-color: var(--header-bg); height: 60px; padding: 0 20px;
            border-bottom: 1px solid var(--border-color); display: flex; align-items: center; justify-content: space-between;
            flex-shrink: 0; z-index: 100; position: relative;
        }

        .brand { font-size: 16px; font-weight: 800; color: #fff; letter-spacing: -0.5px; margin-right: 20px; flex-shrink: 0; }
        
        .controls { display: flex; gap: 8px; align-items: center; margin-left: auto; }
        
        .btn {
            background: transparent; color: #aaa; border: 1px solid var(--btn-border);
            padding: 0 14px; height: 34px; font-size: 12px; border-radius: 17px; 
            cursor: pointer; transition: all 0.2s; font-weight: 600; display: flex; align-items: center; white-space: nowrap;
        }
        .btn:hover { background: var(--btn-hover); color: #fff; border-color: #777; }
        .btn.active { background: var(--btn-active-bg); color: var(--btn-active-text); border-color: var(--btn-active-bg); font-weight: 800; }
        label.btn { display: inline-flex; margin: 0; }
        input[type="file"] { display: none; }
        .divider { width: 1px; height: 16px; background: #444; margin: 0 4px; }

        .mini-btn {
            background: #333; border: 1px solid #555; color: #ccc; padding: 3px 8px; font-size: 11px; border-radius: 4px; cursor: pointer; transition: 0.2s;
        }
        .mini-btn:hover { background: #555; color: #fff; }
        .mini-btn.danger { color: #ff6b6b; border-color: #ff6b6b; background: transparent; }
        .mini-btn.danger:hover { background: #ff6b6b; color: #fff; }

        /* === ë©”ì¸ ë ˆì´ì•„ì›ƒ === */
        #app-container {
            display: flex; width: 100%; height: calc(100% - 60px); position: relative;
        }

        /* ì—ë””í„° íŒ¨ë„ */
        #editor-panel {
            width: 0; 
            display: flex; flex-direction: column; 
            background: var(--panel-bg); border-right: 1px solid var(--border-color);
            transition: width 0.35s cubic-bezier(0.25, 1, 0.5, 1); 
            position: relative; z-index: 50;
            overflow: hidden; 
        }
        #editor-panel.open { width: 40%; min-width: 350px; } 

        .editor-toolbar {
            height: 40px; padding: 0 15px; display: flex; align-items: center; justify-content: space-between;
            background: #222; border-bottom: 1px solid #333; font-size: 12px; color: #888; font-weight: bold; flex-shrink: 0;
            width: 100%; 
        }
        .editor-tools { display: flex; gap: 6px; }

        textarea#live-editor {
            flex: 1; width: 100%; background: #151515; color: #ccc; border: none; 
            padding: 20px; font-family: "Consolas", "Monaco", monospace; font-size: 13px; line-height: 1.6; resize: none; 
            white-space: pre-wrap; word-break: break-all; overflow-x: hidden; 
            overflow-y: auto; touch-action: pan-y; 
        }

        /* í”„ë¦¬ë·° ì˜ì—­ */
        main {
            flex: 1; position: relative; overflow: hidden; 
            display: flex; flex-direction: column; background-color: #121212;
            background-image: radial-gradient(#252525 1px, transparent 1px); background-size: 24px 24px;
            transition: all 0.3s;
            touch-action: none; 
        }
        
        .scroll-area {
            flex: 1; overflow: auto; display: flex; justify-content: center; align-items: flex-start; 
            padding: 40px; 
            transition: padding 0.3s ease;
            overflow-x: hidden; 
            touch-action: pan-x pan-y;
            -webkit-overflow-scrolling: touch;
        }
        .editor-open-mode .scroll-area { padding: 10px; }

        #scale-wrapper {
            transform-origin: top center; transition: transform 0.2s ease-out; 
            margin-bottom: 100px;
        }

        .iframe-container {
            background: #121212; overflow: hidden; 
            border: 12px solid var(--panel-bg); border-radius: 20px;
            box-shadow: 0 30px 80px rgba(0,0,0,0.5);
            box-sizing: content-box; 
        }
        iframe { width: 100%; height: 100%; border: none; background: #121212; display: block; }

        .mode-pc { width: 1050px; height: 900px; }
        .mode-mobile { width: 375px; height: 812px; border-width: 14px; border-radius: 40px; }

        /* [ìŠ¬ë¼ì´ë“œ í† ê¸€ ë²„íŠ¼] */
        #slide-toggle-btn {
            position: absolute; 
            top: 80px; 
            left: 10px; 
            transform: translateY(0); 
            width: 30px; height: 50px; 
            background: rgba(40, 40, 40, 0.65); 
            backdrop-filter: blur(4px);
            border-radius: 8px; 
            border: 1px solid rgba(255, 255, 255, 0.2); 
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); 
            z-index: 60; cursor: pointer; color: #ccc; display: flex; align-items: center; justify-content: center;
            font-size: 10px;
            transition: left 0.35s cubic-bezier(0.25, 1, 0.5, 1); 
        }
        #slide-toggle-btn:hover { background: rgba(60, 60, 60, 0.8); color: #fff; border-color: rgba(255, 255, 255, 0.4); }

        #editor-panel.open ~ #slide-toggle-btn { left: calc(40% - 15px); }

        .code-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px); z-index: 200; display: none; justify-content: center; align-items: center;
            touch-action: none; 
        }
        .code-overlay.open { display: flex; }
        .editor-modal { width: 700px; height: 80%; background: #222; border: 1px solid #444; border-radius: 16px; padding: 20px; display: flex; flex-direction: column; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .modal-ta { flex: 1; background: #111; border: 1px solid #333; color: #ccc; padding: 15px; border-radius: 8px; resize: none; margin-bottom: 15px; touch-action: pan-y;}
        .modal-actions { display: flex; justify-content: flex-end; gap: 10px; }

        /* ğŸš¨ ëª¨ë°”ì¼ ìµœì í™” */
        @media (max-width: 768px) {
            .brand { display: none; } 
            
            .controls { 
                display: flex; flex: 1; 
                overflow-x: auto; white-space: nowrap; 
                -webkit-overflow-scrolling: touch; 
                padding-right: 10px; 
            }
            .controls::-webkit-scrollbar { display: none; }

            #editor-panel { 
                position: absolute; top: 0; left: 0; height: 100%; 
                width: 0; min-width: 0; 
                border-right: 1px solid #333;
                box-shadow: 5px 0 15px rgba(0,0,0,0.5);
                overflow: hidden; 
            }
            #editor-panel.open { width: 85%; } 

            #slide-toggle-btn { left: 10px; display: flex !important; }
            #editor-panel.open ~ #slide-toggle-btn { left: calc(85% - 15px); } 

            .editor-modal { width: 90%; height: 90%; }
        }
    </style>
</head>
<body> 

    <header>
        <div class="brand">YUMGOOD</div>
        <div class="controls">
            <button class="btn active" onclick="setView(this, 'pc')">PC Full</button>
            <button class="btn" onclick="setView(this, 'mobile')">Mobile</button>
            <div class="divider"></div>
            <label class="btn">íŒŒì¼ ì—´ê¸° <input type="file" accept=".html" onchange="loadFile(event)"></label>
            <button class="btn" onclick="openPasteModal()">ì½”ë“œ ë¶™ì—¬ë„£ê¸°</button>
            <button class="btn" onclick="refreshFrame()">ìƒˆë¡œê³ ì¹¨</button>
        </div>
    </header>

    <div id="app-container">
        <div id="editor-panel">
            <div class="editor-toolbar">
                <div style="display:flex; align-items:center; gap:8px;">
                    <span>LIVE EDITOR</span>
                    <span id="editor-char-count" style="font-weight:400; font-size:11px; color:#666;">0ì</span>
                </div>
                <div class="editor-tools">
                    <button class="mini-btn" onclick="copyEditor()">ì „ì²´ë³µì‚¬</button>
                    <button class="mini-btn danger" onclick="clearEditor()">ì „ì²´ì‚­ì œ</button>
                </div>
            </div>
            <textarea id="live-editor" placeholder="ì—¬ê¸°ì— ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”." spellcheck="false"></textarea>
        </div>

        <div id="slide-toggle-btn" onclick="toggleEditor()" title="ì—ë””í„° ì—´ê¸°/ì ‘ê¸°">â–¶</div>

        <main>
            <div class="scroll-area">
                <div id="scale-wrapper">
                    <div id="wrapper" class="iframe-container mode-pc">
                        <iframe id="previewFrame"></iframe>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div id="codeOverlay" class="code-overlay">
        <div class="editor-modal">
            <div class="modal-header">
                <div style="color:#fff; font-weight:bold;">ì½”ë“œ ë¶™ì—¬ë„£ê¸°</div>
                <button class="mini-btn danger" onclick="clearModalInput()">ë‚´ìš© ë¹„ìš°ê¸°</button>
            </div>
            <textarea id="modalInput" class="modal-ta" placeholder="HTML ì½”ë“œë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”..."></textarea>
            <div class="modal-actions">
                <button class="btn" onclick="closePasteModal()">ë‹«ê¸°</button>
                <button class="btn" style="background:#eee; color:#000;" onclick="applyModalCode()">ì ìš©</button>
            </div>
        </div>
    </div>

    <script>
        const frame = document.getElementById('previewFrame');
        const wrapper = document.getElementById('wrapper');
        const scaleWrapper = document.getElementById('scale-wrapper');
        const liveEditor = document.getElementById('live-editor');
        const editorPanel = document.getElementById('editor-panel');
        const scrollArea = document.querySelector('.scroll-area');
        const toggleBtn = document.getElementById('slide-toggle-btn');
        const modalOverlay = document.getElementById('codeOverlay');
        const modalInput = document.getElementById('modalInput');
        
        let currentBlobUrl = null;
        let currentMode = 'pc'; 
        let currentCode = "";
        let debounceTimer;

        // iOS ìŠ¤í¬ë¡¤ íŠ•ê¹€ ë°©ì§€
        document.addEventListener('touchmove', function(e) {
            if (e.target.closest('#live-editor') || 
                e.target.closest('.modal-ta') || 
                e.target.closest('.controls') ||
                e.target.closest('.scroll-area')) {
                return; 
            }
            e.preventDefault();
        }, { passive: false });

        function toggleEditor() {
            const isOpen = editorPanel.classList.toggle('open');
            document.body.classList.toggle('editor-open-mode', isOpen);
            toggleBtn.innerText = isOpen ? "â—€" : "â–¶";
            setTimeout(fitToScreen, 50);  
            setTimeout(fitToScreen, 200); 
            setTimeout(fitToScreen, 360); 
        }

        liveEditor.addEventListener('input', function() {
            const code = this.value;
            currentCode = code;
            document.getElementById('editor-char-count').innerText = code.length.toLocaleString() + "ì";
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(() => updatePreview(code), 300);
        });

        function loadFile(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                setCode(e.target.result);
                event.target.value = ''; 
            };
            reader.readAsText(file, 'UTF-8');
        }

        function openPasteModal() {
            modalOverlay.classList.add('open');
            modalInput.value = currentCode; 
            modalInput.focus();
        }
        function closePasteModal() { modalOverlay.classList.remove('open'); }
        function clearModalInput() { modalInput.value = ''; modalInput.focus(); }

        function applyModalCode() {
            setCode(modalInput.value);
            closePasteModal();
        }

        function copyEditor() {
            if (!liveEditor.value) return;
            navigator.clipboard.writeText(liveEditor.value).then(() => alert('ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.'));
        }
        function clearEditor() {
            if(confirm('ì •ë§ ë‚´ìš©ì„ ëª¨ë‘ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?')) setCode('');
        }

        function setCode(code) {
            currentCode = code;
            liveEditor.value = code;
            document.getElementById('editor-char-count').innerText = code.length.toLocaleString() + "ì";
            updatePreview(code);
        }

        function updatePreview(htmlContent) {
            if (currentBlobUrl) URL.revokeObjectURL(currentBlobUrl);
            const blob = new Blob([htmlContent], { type: 'text/html' });
            currentBlobUrl = URL.createObjectURL(blob);
            frame.src = currentBlobUrl;
        }

        function fitToScreen() {
            const availableWidth = scrollArea.clientWidth;
            const availableHeight = scrollArea.clientHeight;

            if (currentMode === 'mobile') {
                // [ìš”ì²­ì‚¬í•­ ë°˜ì˜] ì‚¬ìš©ìì˜ ë””ìŠ¤í”Œë ˆì´ ì„¸ë¡œ ë†’ì´ì— ì¹´ë“œ ë§ì¶¤
                const baseWidth = 375 + 40; 
                const baseHeight = 812; // ëª¨ë°”ì¼ ì¹´ë“œì˜ ê¸°ì¤€ ë†’ì´
                
                // ê°€ë¡œ ë°°ìœ¨ê³¼ ì„¸ë¡œ ë°°ìœ¨ ì¤‘ ë” ì‘ì€ ìª½ì„ ì„ íƒí•˜ì—¬ í™”ë©´ì— ì™ ë„£ìŒ
                const scaleW = availableWidth / baseWidth;
                const scaleH = (availableHeight - 60) / baseHeight; // í•˜ë‹¨ ì—¬ë°± ê³µê°„ í™•ë³´ìš© -60
                
                let scale = Math.min(scaleW, scaleH, 1);
                scaleWrapper.style.transform = `scale(${scale})`;
                
                // [ìš”ì²­ì‚¬í•­ ë°˜ì˜] í•˜ë‹¨ì— ì•½ 40pxì˜ ì‹œê°ì  ì—¬ë°± ì¶”ê°€
                scaleWrapper.style.marginBottom = '40px'; 
                return;
            }

            // [PC ëª¨ë“œ] - ì›ë³¸ ë¡¤ë°± ë²„ì „ì˜ ë¡œì§ ìœ ì§€
            const targetWidth = 1080; 
            const isMobileScreen = window.innerWidth <= 768;
            const padding = editorPanel.classList.contains('open') ? 20 : (isMobileScreen ? 20 : 80);
            
            let scale = (availableWidth - padding) / targetWidth;
            if (scale > 1) scale = 1; 
            if (scale < 0.2) scale = 0.2;
            
            scaleWrapper.style.transform = `scale(${scale})`;

            const h = wrapper.offsetHeight; 
            const buffer = isMobileScreen ? '20vh' : '100px'; 
            const negativeMargin = h * (1 - scale);
            scaleWrapper.style.marginBottom = `calc(-${negativeMargin}px + ${buffer})`;
        }

        window.addEventListener('resize', () => { clearTimeout(debounceTimer); debounceTimer = setTimeout(fitToScreen, 100); });

        function setView(btn, mode) {
            document.querySelectorAll('.controls .btn').forEach(b => {
                if(['PC Full', 'Mobile'].includes(b.innerText)) b.classList.remove('active');
            });
            btn.classList.add('active');
            currentMode = mode;
            wrapper.className = 'iframe-container';
            wrapper.classList.add('mode-' + mode);
            fitToScreen();
        }

        function refreshFrame() { if (frame.contentWindow) frame.contentWindow.location.reload(); }

        toggleBtn.innerText = "â–¶";
        fitToScreen();
    </script>
</body>
</html>
